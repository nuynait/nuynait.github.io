<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> iOS Settings Bundle · Tianyun Shan</title><meta name="description" content="iOS Settings Bundle - Tianyun Shan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.jerryshan.com/atom.xml" title="Tianyun Shan"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">iOS Settings Bundle</h1><div class="post-info">Dec 14, 2016</div><div class="post-content"><p>This blog talks about the basic of iOS Settings Bundle. If your app only needs to include basic setting options, you can use the iOS Settings Bundle to include all the setting options into the native iOS settings app. It has been used heavily in my <a target="_blank" rel="noopener" href="http://hourglasslab.com/">Hourglass</a> app for all the setting options, and it works pretty well.</p>
<span id="more"></span>

<h1 id="Create-Settings-Bundle"><a href="#Create-Settings-Bundle" class="headerlink" title="Create Settings Bundle"></a>Create Settings Bundle</h1><p>Go to Menu File -&gt; New -&gt; File…, choose the Settings Bundle in the popup and choose a save location. After that you can see a folder called Settings Bundle available in your project. There is a file named <code>Root.plist</code> and that is the root file for your app’s setting page.</p>
<p>In the <code>Root.plist</code>, under <code>Preference Items</code> you can see all the widget you have in your setting page. It will pre-generate some and you can always delete them and create your own.</p>
<p>Below will introduce some of the preference item and how you set them it. It will not cover all the types since some are easy to figure out on your own.</p>
<h2 id="Group"><a href="#Group" class="headerlink" title="Group"></a>Group</h2><p>Group usually separates settings and give user a clear idea on what that setting option is for. It is a good idea to always have group to wrap around settings. You must have a title on the top and can optionally create some text to display on footer.</p>
<p><img src="20161214_120319_721UlR.PNG"></p>
<p>To display footer, you need to have a field with key <code>FooterText</code>. It is documented <a target="_blank" rel="noopener" href="https://developer.apple.com/library/content/documentation/PreferenceSettings/Conceptual/SettingsApplicationSchemaReference/Articles/PSGroupSpecifier.html">here</a>.</p>
<h2 id="Child-Pane"><a href="#Child-Pane" class="headerlink" title="Child Pane"></a>Child Pane</h2><p>The <code>Root.plist</code> is your root file for your settings page and you can have many child panes to navigate inside your settings.</p>
<p>First, create a new plist file. First, select the root folder and choose new file from the menu, select property list and create. After creating the new property file, drag it into the settings bundle in the navigation panel and the file will be <strong>copied</strong> into the settings bundle. Remove the one that you created in the root project folder, and move it into trash.</p>
<p>Back to <code>Root.plist</code>, create a new preference item. Expand the new item you created and in the value for key <code>Type</code>, select <code>Child Panel</code>. Note that if you drop down in the Item x area, you may not see child pane option available.</p>
<p>The value you need to edit are <code>Type</code>, <code>Title</code>, <code>Filename</code>. Title is obviously the title displayed on the table cell, and the file name is the file name for that newly created plist file.</p>
<p>Select the plist file you just created, right click on white empty area, select property list type and choose the last one <code>iPhone Settings plist</code>.</p>
<p>Create key <code>Strings Filename</code> and set value as <code>Root</code>. Note: this is not the file name of the file, please set it as the parent file name and all file names above doesn’t contains extension when put into the values field as well.</p>
<p><img src="iOS%20Settings%20Bundle/20161214_125024_721hvX.png"></p>
<h1 id="Sync-Settings-Back"><a href="#Sync-Settings-Back" class="headerlink" title="Sync Settings Back"></a>Sync Settings Back</h1><p>Now you have settings in iOS default settings app, and users can manipulate values there, but you need to reflect them into the app when user changes them. Here is how you do it.</p>
<p>First, it is always recommend to create a new class for manage the settings. Here I will call it <code>HGSettings.swift</code>.</p>
<p>I prefer to make that class singleton for easy access anywhere else.</p>
<p>The first thing to do in that class is to set the default value for shared preference. Yes, you did set defaults when you create the settings bundle, but the default value there is only for the appearance of all the widget and it do not register the defaults in User Defaults</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UserDefaults</span>.standard.register(defaults: [</span><br><span class="line">                                 <span class="string">&quot;key1&quot;</span>: value1</span><br><span class="line">                                 <span class="string">&quot;key2&quot;</span>: value2</span><br><span class="line">                               ])</span><br></pre></td></tr></table></figure>

<p>Don&#39;t forget that you should register all the keys you used in your settings bundle, otherwise when user don&#39;t touch the setting, you will get a nil from that key.</p>
<p>After register the default, you will need to write all the properties. Here is what I prefer to do. Create each property corresponding to each key. Don&#39;t forget to set the property type correctly.</p>
<p>Then write both getter and setter for the property.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> navOptionsEscalators: <span class="type">Bool</span> &#123;</span><br><span class="line">  <span class="keyword">get</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">UserDefaults</span>.standard.bool(forKey: key.navOptionsEscalators.rawValue)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">set</span> &#123;</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.set(newValue, forKey: key.navOptionsEscalators.rawValue)</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.synchronize()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>Here is an example I use when I am writing the navigation app for mapsted, I use the string enum to store all the keys.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  MNSettingUtils.swift</span></span><br><span class="line"><span class="comment">//  nav</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Tianyun Shan on 2016-12-14.</span></span><br><span class="line"><span class="comment">//  Copyright © 2016 Maspted. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MNSettingUtils</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">let</span> sharedInstance <span class="operator">=</span> <span class="type">MNSettingUtils</span>()</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">enum</span> <span class="title">key</span>: <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> navOptionsEscalators <span class="operator">=</span> <span class="string">&quot;MNNavOptionsEscalators&quot;</span></span><br><span class="line">    <span class="keyword">case</span> navOptionsStairs <span class="operator">=</span> <span class="string">&quot;MNNavOptionsStairs&quot;</span></span><br><span class="line">    <span class="keyword">case</span> navOptionsElevators <span class="operator">=</span> <span class="string">&quot;MNNavOptionsElevators&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">init</span>()</span> &#123;</span><br><span class="line">    registerDefaults()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">registerDefaults</span>()</span> &#123;</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.register(defaults: [</span><br><span class="line">      key.navOptionsEscalators.rawValue: <span class="literal">true</span>,</span><br><span class="line">      key.navOptionsElevators.rawValue: <span class="literal">true</span>,</span><br><span class="line">      key.navOptionsStairs.rawValue: <span class="literal">true</span></span><br><span class="line">      ])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">changeValues</span>(<span class="params">value</span>: <span class="keyword">Any</span>, <span class="params">key</span>: <span class="type">String</span>)</span> &#123;</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.set(value, forKey: key)</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.synchronize()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// variable options</span></span><br><span class="line">  <span class="keyword">var</span> navOptionsEscalators: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">get</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">UserDefaults</span>.standard.bool(forKey: key.navOptionsEscalators.rawValue)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> &#123;</span><br><span class="line">      changeValues(value: newValue, key: key.navOptionsEscalators.rawValue)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> navOptionsStairs: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">get</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">UserDefaults</span>.standard.bool(forKey: key.navOptionsStairs.rawValue)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">set</span> &#123;</span><br><span class="line">      changeValues(value: newValue, key: key.navOptionsStairs.rawValue)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> navOptionsElevators: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">get</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">UserDefaults</span>.standard.bool(forKey: key.navOptionsStairs.rawValue)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> &#123;</span><br><span class="line">      changeValues(value: newValue, key: key.navOptionsStairs.rawValue)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h1><p>If you have any additional questions when using Settings Bundle, you may find the answers here</p>
<h2 id="nothing-shows-in-settings"><a href="#nothing-shows-in-settings" class="headerlink" title="nothing shows in settings"></a>nothing shows in settings</h2><p>Try to close the settings app and reopen it. It only happens when you compile the app and will be find when user is downloading them from the test flight or app store.</p>
<h2 id="How-do-I-Reorder-the-Preference-Items"><a href="#How-do-I-Reorder-the-Preference-Items" class="headerlink" title="How do I Reorder the Preference Items?"></a>How do I Reorder the Preference Items?</h2><p>To reorder, try to drag at the end on the right side. It is a little bit hard sometimes for it to recognize the dragging action. When you start dragging it, move the mouse to the left, it is the only place to insert into the row.</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol>
<li> <a target="_blank" rel="noopener" href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/UserDefaults/Preferences/Preferences.html">implementing settings bundle</a></li>
</ol>
</div></article></div></main><footer><div class="paginator"><a href="/2017/01/17/Create%20C++%20Static%20Library%20and%20Use%20in%20Swift/" class="prev">PREV</a><a href="/2016/11/08/Basic%20of%20Core%20Data%20Framework/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://blog.jerryshan.com">Tianyun Shan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>