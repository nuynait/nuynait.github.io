<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Apple Bluetooth LE Peripheral Â· Tianyun Shan</title><meta name="description" content="Apple Bluetooth LE Peripheral - Tianyun Shan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.jerryshan.com/atom.xml" title="Tianyun Shan"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Apple Bluetooth LE Peripheral</h1><div class="post-info">May 2, 2017</div><div class="post-content"><p>I personally has lots of experience with <code>CoreBluetooth</code>. I also did look at the <code>GATT</code> for sometime so I understand how service, characteristics, descriptor works. This note will focus mainly on implementation and how to make Android device work as peripheral and iOS as central to get data transfer from Android to iOS.</p>
<p>This blog will be updated in the future to finish all its contents.</p>
<span id="more"></span>


<h1 id="Android-Peripheral"><a href="#Android-Peripheral" class="headerlink" title="Android Peripheral"></a>Android Peripheral</h1><p>Android peripheral is different a little bit from iOS. First its advertise and <code>GATT</code> service are separates. So let&#39;s take about advertise first.</p>
<h2 id="Advertise"><a href="#Advertise" class="headerlink" title="Advertise"></a>Advertise</h2><p>We need a <code>BluetoothLeAdvertiser</code>, <code>AdvertiseCallback</code> to do the job. First, we need to check if the device supports Bluetooth Low Energy. Keep in mind that even if the device supports Bluetooth Low Energy, it can still don&#39;t support advertise or scan.</p>
<p>So first define class variables.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">private BluetoothLeAdvertiser mBLEAdvertiser;</span><br><span class="line">private final AdvertiseCallback mAdvCallback &#x3D; new AdvertiseCallback() &#123;</span><br><span class="line">  @Override</span><br><span class="line">  public void onStartSuccess(AdvertiseSettings settingsInEffect) &#123;</span><br><span class="line">    super.onStartSuccess(settingsInEffect);</span><br><span class="line">    Toast.makeText(mContext, &quot;Advertise Start Successfully&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">    Log.d(LOG_TAG, &quot;Advertise Start Successfully&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void onStartFailure(int errorCode) &#123;</span><br><span class="line">    super.onStartFailure(errorCode);</span><br><span class="line">    Toast.makeText(mContext, &quot;Advertise Start Error, Code &quot; + String.valueOf(errorCode), Toast.LENGTH_SHORT).show();</span><br><span class="line">    Log.e(LOG_TAG, &quot;Advertise Start Error, Code &quot; + String.valueOf(errorCode));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Check if support Bluetooth Low Energy and initialize advertiser.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public Boolean initializeBTLE() &#123;</span><br><span class="line">  boolean hasBLE &#x3D; mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH_LE);</span><br><span class="line">  if (!hasBLE) &#123;</span><br><span class="line">    Toast.makeText(mContext, &quot;Bluetooth Low Energy Not Supported On Phone&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">    Log.e(LOG_TAG, &quot;Bluetooth Low Energy Not Supported On Phone.&quot;);</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  mBLEAdvertiser &#x3D; BluetoothAdapter.getDefaultAdapter().getBluetoothLeAdvertiser();</span><br><span class="line">  if (mBLEAdvertiser &#x3D;&#x3D; null) &#123;</span><br><span class="line">    Toast.makeText(mContext, &quot;Cannot Initialize BTLE Advertiser&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">    Log.e(LOG_TAG, &quot;Cannot Initialize BTLE Advertiser.&quot;);</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; this will mention later about how to create gatt server</span><br><span class="line">  return createGattService();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now write the advertise function. Initialize <code>advSetting</code> and <code>advData</code>. We need to pass in a <code>ParcelUuid</code> as service <code>UUID</code> for advertise. This service <code>UUID</code> is for advertise only and has no connection with <code>GATT</code> protocol. Call the <code>startAdvertise</code> and pass in the setting and data we just created and the advertise callback function we created before.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public void startAdvertise() &#123;</span><br><span class="line">  AdvertiseSettings advSettings &#x3D; new AdvertiseSettings.Builder()</span><br><span class="line">    .setAdvertiseMode(AdvertiseSettings.ADVERTISE_MODE_LOW_LATENCY)</span><br><span class="line">    .setTxPowerLevel(AdvertiseSettings.ADVERTISE_TX_POWER_HIGH)</span><br><span class="line">    .setConnectable(true)</span><br><span class="line">    .build();</span><br><span class="line"></span><br><span class="line">  ParcelUuid deviceUUID &#x3D; ParcelUuid.fromString(mContext.getString(R.string.ble_uuid));</span><br><span class="line">  AdvertiseData advData &#x3D; new AdvertiseData.Builder()</span><br><span class="line">    .addServiceUuid(deviceUUID)</span><br><span class="line">    .build();</span><br><span class="line"></span><br><span class="line">  if (advSettings &#x3D;&#x3D; null || advData &#x3D;&#x3D; null) &#123;</span><br><span class="line">    Toast.makeText(mContext, &quot;Cannot create AdvertiseSettings or AdvertiseData&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">    Log.e(LOG_TAG, &quot;Cannot create AdvertiseSettings or AdvertiseData&quot;);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  mBLEAdvertiser.startAdvertising(advSettings, advData, mAdvCallback);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If we ever need to stop the advertise process, this is what we do.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public void stopAdvertise() &#123;</span><br><span class="line">  if (mBLEAdvertiser !&#x3D; null &amp;&amp; mAdvCallback !&#x3D; null) &#123;</span><br><span class="line">    mBLEAdvertiser.stopAdvertising(mAdvCallback);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="GATT-Server"><a href="#GATT-Server" class="headerlink" title="GATT Server"></a>GATT Server</h2><p>Now at this point, the iOS Central should be able to discover the Android Peripheral device. We need to continue setting up a <code>GATT</code> server to make iOS connectable.</p>
<p>So we need a <code>BluetoothManager</code>, a <code>BluetoothGattServer</code>, a <code>BluetoothGattCharacteristic</code>, a <code>BluetoothGattServerCallBack</code>.</p>
<p>For other objects such as <code>BluetoothGATTService</code> etc, we can have them locally in function. The reason that <code>BluetoothGattCharacteristic</code> needs to be a class property is because we need to set value for characteristic when notify the peripheral.</p>
<p>Here are the initializations.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">private BluetoothManager mManager;</span><br><span class="line">private BluetoothGattServer mGattServer;</span><br><span class="line">private BluetoothGattCharacteristic mCharacteristic;</span><br><span class="line"></span><br><span class="line">private Boolean createGattService() &#123;</span><br><span class="line">  mManager &#x3D; (BluetoothManager)mContext.getSystemService(Context.BLUETOOTH_SERVICE);</span><br><span class="line">  if (mManager &#x3D;&#x3D; null) &#123;</span><br><span class="line">    Toast.makeText(mContext, &quot;Cannot Initialize Bluetooth Manager&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">    Log.e(LOG_TAG, &quot;Cannot Initialize Bluetooth Manager.&quot;);</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  mGattServer &#x3D; mManager.openGattServer(mContext, mGattServerCallback);</span><br><span class="line">  if (mGattServer &#x3D;&#x3D; null) &#123;</span><br><span class="line">    Toast.makeText(mContext, &quot;Cannot Create Gatt Server&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">    Log.e(LOG_TAG, &quot;Cannot Create Gatt Server.&quot;);</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Setup service and characteristic.</span><br><span class="line">  addDeviceService();</span><br><span class="line">  return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now for creating service and characteristic, we need to have two more individual uuid for service and characteristic. It should be different from the device uuid we used before for advertise.</p>
<p>If we need peripheral to subscribe characteristic, we need to implement a Descriptor with a specific uuid <code>00002902-0000-1000-8000-00805F9B34FB</code>.</p>
<p>This uuid is found in <a target="_blank" rel="noopener" href="https://www.bluetooth.com/specifications/gatt/descriptors">Bluetooth SIG</a> as Client Characteristic Configuration. From the Doc, the Assigned Number for that is <code>0x2902</code> add base UUID to convert it from 16 bit to 128 bit. <a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/36212020/how-can-i-convert-a-bluetooth-16-bit-service-uuid-into-a-128-bit-uuid">Here</a> is the introduction on how to convert.</p>
<p>Moreover we need to give it a write permission and implement the <code>onDescriptorWriteRequest</code> for <code>BluetoothGATTServerCallBack</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">private void addDeviceService() &#123;</span><br><span class="line">    &#x2F;&#x2F; Remove previous Service</span><br><span class="line">    BluetoothGattService previousService &#x3D; mGattServer.getService(UUID.fromString(mContext.getString(R.string.service_uuid)));</span><br><span class="line">    if (previousService !&#x3D; null) &#123;</span><br><span class="line">        mGattServer.removeService(previousService);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Create new service and characteristics</span><br><span class="line">    mCharacteristic &#x3D; new BluetoothGattCharacteristic(</span><br><span class="line">                                                      UUID.fromString(mContext.getString(R.string.characteristic_uuid)),</span><br><span class="line">                                                      BluetoothGattCharacteristic.PROPERTY_NOTIFY,</span><br><span class="line">                                                      BluetoothGattCharacteristic.PERMISSION_READ);</span><br><span class="line"></span><br><span class="line">    BluetoothGattDescriptor myDescriptor &#x3D; new BluetoothGattDescriptor(</span><br><span class="line">                                                                       UUID.fromString(mContext.getString(R.string.notify_descriptor_uuid)),</span><br><span class="line">                                                                       BluetoothGattDescriptor.PERMISSION_WRITE | BluetoothGattDescriptor.PERMISSION_READ);</span><br><span class="line">    mCharacteristic.addDescriptor(myDescriptor);</span><br><span class="line"></span><br><span class="line">    mService &#x3D; new BluetoothGattService(</span><br><span class="line">                                        UUID.fromString(mContext.getString(R.string.service_uuid)),</span><br><span class="line">                                        BluetoothGattService.SERVICE_TYPE_PRIMARY);</span><br><span class="line"></span><br><span class="line">    mService.addCharacteristic(mCharacteristic);</span><br><span class="line">    mGattServer.addService(mService);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now we need to implement the <code>BluetoothGattServerCallback</code>. There are couple callbacks we need to handle in order to make it works. First is <code>onDescriptorWriteRequest</code>. We need to call <code>mGattServer.sendResponse(...)</code>. That callback gets called when peripheral asked to notify a characteristics and <code>sendResponse</code> tells peripheral that notify success.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">private final BluetoothGattServerCallback mGattServerCallback &#x3D; new BluetoothGattServerCallback() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void onDescriptorWriteRequest(BluetoothDevice device, int requestId, BluetoothGattDescriptor descriptor, boolean preparedWrite, boolean responseNeeded, int offset, byte[] value) &#123;</span><br><span class="line">            super.onDescriptorWriteRequest(device, requestId, descriptor, preparedWrite, responseNeeded, offset, value);</span><br><span class="line">            mGattServer.sendResponse(device, requestId, BluetoothGatt.GATT_SUCCESS, offset, value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<p>Now the peripheral is able to notify the characteristics and we can send data whatever and whenever we want.</p>
<h2 id="Send-Data"><a href="#Send-Data" class="headerlink" title="Send Data"></a>Send Data</h2><p>When sending data, every time we set value in characteristic and then notify the client. For each notify, we can only put maximum 20 bytes of data into the characteristic. So if we want to send data more than 20 bytes, this is what we do.</p>
<p>We notify it several times and send an &quot;EOF&quot; string to indicate that data has been all sent and on peripheral we can then combine all received data together.</p>
<p>So first I wrote a <code>DataSendManager</code> class. Calling the constructor to pass-in the total data we want to send. And each time we set data in characteristics, we call <code>getNextData()</code> to get the chunk of the data we need to send. If <code>getNextData()</code> returns null, then all data including the &quot;EOF&quot; string has been sent.</p>
<p>Here is the <code>DataSendManager</code> class.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">class DataSendManager &#123;</span><br><span class="line">    private final String LOG_TAG &#x3D; &quot;Data Sender&quot;;</span><br><span class="line">    private final int MAX_DATA_LENGTH &#x3D; 20; &#x2F;&#x2F; bytes</span><br><span class="line">    private final byte[] EOF &#x3D; &quot;EOF&quot;.getBytes(Charset.forName(&quot;UTF-8&quot;));</span><br><span class="line"></span><br><span class="line">    private byte[] data;</span><br><span class="line">    private int startIndex;</span><br><span class="line">    private boolean isFinished;</span><br><span class="line"></span><br><span class="line">    DataSendManager(String stringToSend) &#123;</span><br><span class="line">        data &#x3D; stringToSend.getBytes(Charset.forName(&quot;UTF-8&quot;));</span><br><span class="line">        initializeManager();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    DataSendManager(byte[] data) &#123;</span><br><span class="line">        this.data &#x3D; data;</span><br><span class="line">        initializeManager();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void initializeManager() &#123;</span><br><span class="line">        startIndex &#x3D; 0;</span><br><span class="line">        isFinished &#x3D; false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public byte[] getNextData() &#123;</span><br><span class="line">        if (isFinished) &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (startIndex &#x3D;&#x3D; data.length - 1) &#123;</span><br><span class="line">            Log.d(LOG_TAG, &quot;All data has been sent. Send EOF&quot;);</span><br><span class="line">            isFinished &#x3D; true;</span><br><span class="line">            return EOF;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        int endIndex &#x3D; startIndex + MAX_DATA_LENGTH &gt;&#x3D; data.length ? data.length : startIndex + MAX_DATA_LENGTH;</span><br><span class="line">        byte[] dataToSend &#x3D; Arrays.copyOfRange(data, startIndex, endIndex);</span><br><span class="line">        startIndex &#x3D; endIndex - 1;</span><br><span class="line">        return dataToSend;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here is an example for sending the data.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public void sendLocTo(byte[] data) &#123;</span><br><span class="line">    DataSendManager mDataSendManager &#x3D; new DataSendManager(data);</span><br><span class="line">    byte[] dataToSend &#x3D; mDataSendManager.getNextData();</span><br><span class="line">    while (dataToSend !&#x3D; null) &#123;</span><br><span class="line">        mCharacteristic.setValue(dataToSend);</span><br><span class="line">        for (BluetoothDevice subscribedDevice : mSubscribedDevices) &#123;</span><br><span class="line">            mGattServer.notifyCharacteristicChanged(subscribedDevice, mCharacteristic, false);</span><br><span class="line">        &#125;</span><br><span class="line">        dataToSend &#x3D; mDataSendManager.getNextData();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2017/05/05/Convert%20Byte%20Array%20to%20Data%20and%20to%20Int/" class="prev">PREV</a><a href="/2017/05/02/Apple%20Bluetooth%20LE%20Central/" class="next">NEXT</a></div><div class="copyright"><p>Â© 2015 - 2021 <a href="http://blog.jerryshan.com">Tianyun Shan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>