<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Apple Bluetooth LE Central Â· Tianyun Shan</title><meta name="description" content="Apple Bluetooth LE Central - Tianyun Shan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/img.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.jerryshan.com/atom.xml" title="Tianyun Shan"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/img.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Apple Bluetooth LE Central</h1><div class="post-info">May 2, 2017</div><div class="post-content"><p>I personally has lots of experience with <code>CoreBluetooth</code>. I also did look at the <code>GATT</code> for sometime so I understand how service, characteristics, descriptor works. This note will focus mainly on implementation and how to make Android device work as peripheral and iOS as central to get data transfer from Android to iOS.</p>
<p>This blog will be updated in the future to finish all its contents.</p>
<span id="more"></span>

<h1 id="iOS-Central"><a href="#iOS-Central" class="headerlink" title="iOS Central"></a>iOS Central</h1><p><a target="_blank" rel="noopener" href="https://developer.apple.com/library/content/samplecode/BTLE_Transfer/Introduction/Intro.html#//apple_ref/doc/uid/DTS40012927-Intro-DontLinkElementID_2">This</a> code example worth a million words. It provide an example of a <code>Peripheral</code> role and a <code>Central</code> role.</p>
<p>Here is a brief explanation. For <strong>Central</strong>, it is responsible for scanning the device, connect, search for the specific peripheral and set notify to the characteristics. When anything updates, it receives the data comes every 20 bytes and combine them all at the end when finished.</p>
<p>So here are the steps in sequential.</p>
<h2 id="Check-Bluetooth-State"><a href="#Check-Bluetooth-State" class="headerlink" title="Check Bluetooth State"></a>Check Bluetooth State</h2><p>First, use <code>centralManagerDidUpdateState</code> to check the state of the Bluetooth. Handle all 5 states. <code>.poweredOn</code>, <code>.poweredOff</code>, <code>.resetting</code>, <code>.unauthorized</code>, <code>unknown</code>, <code>unsupported</code>. If the state is <code>.poweredOn</code>, scan for peripherals.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">func centralManagerDidUpdateState(_ central: CBCentralManager) &#123;</span><br><span class="line">  switch central.state &#123;</span><br><span class="line">  case .poweredOn:</span><br><span class="line">    scan()</span><br><span class="line">  case .poweredOff:</span><br><span class="line">    print(&quot;bluetooth is powered off.&quot;)</span><br><span class="line">  case .resetting:</span><br><span class="line">    print(&quot;bluetooth is resetting.&quot;)</span><br><span class="line">  case .unauthorized:</span><br><span class="line">    print(&quot;bluetooth is unauthorized.&quot;)</span><br><span class="line">  case .unknown:</span><br><span class="line">    print(&quot;bluetooth is unknown.&quot;)</span><br><span class="line">  case .unsupported:</span><br><span class="line">    print(&quot;bluetooth is unsupported.&quot;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Scan"><a href="#Scan" class="headerlink" title="Scan"></a>Scan</h2><p>Provide a <code>uuid</code> to scan.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func scan() &#123;</span><br><span class="line">  centralManager.scanForPeripherals(withServices: [CBUUID(string: UUIDString)],</span><br><span class="line">                                    options: [CBCentralManagerScanOptionAllowDuplicatesKey: true])</span><br><span class="line">  print(&quot;scan started&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Discover"><a href="#Discover" class="headerlink" title="Discover"></a>Discover</h2><p>When a device with our specific <code>uuid</code> approach, the discover callback will get called. Check the <code>RSSI</code> if you want to filter distance for too far away. Then check if that device is already discovered. Finally, connect to the peripheral.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">func centralManager(_ central: CBCentralManager, didDiscover peripheral: CBPeripheral, advertisementData: [String : Any], rssi RSSI: NSNumber) &#123;</span><br><span class="line">  &#x2F;&#x2F; Reject any where the value is above reasonable range</span><br><span class="line">  if (RSSI.intValue &gt; -15) &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Reject if the signal strength is too low to be close enough (Close is around -22dB)</span><br><span class="line">  if (RSSI.intValue &lt; -35) &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  print(&quot;Discovered \(String(describing: peripheral.name)) at \(RSSI)&quot;)</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Have we already seen this device?</span><br><span class="line">  if (self.discoveredPeripheral !&#x3D; peripheral) &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; save a local copy of the peripheral, so CoreBluetooth doesn&#39;t get rid of it</span><br><span class="line">    self.discoveredPeripheral &#x3D; peripheral</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; And connect</span><br><span class="line">    print(&quot;Connecting to peripheral \(peripheral)&quot;)</span><br><span class="line">    centralManager.connect(peripheral, options: nil)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Connected"><a href="#Connected" class="headerlink" title="Connected"></a>Connected</h2><p>Now implement <code>didConnect</code> and <code>didFailToConnect</code> to see if <code>BLE</code> peripheral has connected successfully. If it connects, we can stop the scan, and assign <code>self</code> to <code>peripheral.delegate</code> and call <code>discoverService</code> with service <code>UUID</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;** If the connection fails for whatever reason, we need to deal with it.</span><br><span class="line"> *&#x2F;</span><br><span class="line">func centralManager(_ central: CBCentralManager, didFailToConnect peripheral: CBPeripheral, error: Error?) &#123;</span><br><span class="line">  print(&quot;Failed to connect to \(peripheral). \(String(describing: error?.localizedDescription))&quot;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** We&#39;ve connected to the peripheral, now we need to discover the services and characteristics to find the &#39;transfer&#39; characteristic.</span><br><span class="line"> *&#x2F;</span><br><span class="line">func centralManager(_ central: CBCentralManager, didConnect peripheral: CBPeripheral) &#123;</span><br><span class="line">  print(&quot;Peripheral Connected&quot;)</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; stop scanning</span><br><span class="line">  centralManager.stopScan()</span><br><span class="line"></span><br><span class="line">  print(&quot;Scanning Stopped&quot;)</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; clear the data that we may already have</span><br><span class="line">  dataReceived &#x3D; nil</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; make sure we get the discovery callbacks</span><br><span class="line">  peripheral.delegate &#x3D; self</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; search only for services that match our UUID</span><br><span class="line">  peripheral.discoverServices([CBUUID(string: serviceUUIDString)])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Did-Discover-Services"><a href="#Did-Discover-Services" class="headerlink" title="Did Discover Services"></a>Did Discover Services</h2><p>Service has been discovered successfully. Now we want to discover the characteristics inside the service.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">func peripheral(_ peripheral: CBPeripheral, didDiscoverServices error: Error?) &#123;</span><br><span class="line">  if let e &#x3D; error &#123;</span><br><span class="line">    print(&quot;error discovering services \(e)&quot;)</span><br><span class="line">    cleanup()</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Discover the characteristic we want</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Loop through the newly filled peripheral.services array, just in case there&#39;s more than one.</span><br><span class="line">  guard let services &#x3D; peripheral.services else &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line">  for service in services &#123;</span><br><span class="line">    peripheral.discoverCharacteristics([CBUUID(string: characteristicUUIDString)], for: service)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Did-Discover-Characteristics"><a href="#Did-Discover-Characteristics" class="headerlink" title="Did Discover Characteristics"></a>Did Discover Characteristics</h2><p>Now we have discover the characteristic we want. So set notify of that characteristic in order to subscribe to it.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;** The Transfer characteristic was discovered.</span><br><span class="line"> *  Once this has been found, we want to subscribe to it, which lets the peripheral know we want the data it contains</span><br><span class="line"> *&#x2F;</span><br><span class="line">func peripheral(_ peripheral: CBPeripheral, didDiscoverCharacteristicsFor service: CBService, error: Error?) &#123;</span><br><span class="line">  if let e &#x3D; error &#123;</span><br><span class="line">    print(&quot;error discovering services \(e)&quot;)</span><br><span class="line">    cleanup()</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line">  print(&quot;Did discover characteristics&quot;)</span><br><span class="line">  &#x2F;&#x2F; Again, we loop through the array, just in case</span><br><span class="line">  guard let characteristics &#x3D; service.characteristics else &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  for characteristic in characteristics &#123;</span><br><span class="line">    if characteristic.uuid.isEqual(CBUUID(string: characteristicUUIDString)) &#123;</span><br><span class="line">      peripheral.setNotifyValue(true, for: characteristic)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; once this is complete we just need to wait for the data to come in</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Get-Notified"><a href="#Get-Notified" class="headerlink" title="Get Notified"></a>Get Notified</h2><p>When central is updating the value, it will notify you that characteristic has changed. Then you get the <code>value</code> from the characteristic and append everything together if its one large data separates before send.</p>
<p>After received all data, we can choose to disconnects or keep the connection and waiting for new batch of data. Its all up to you.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;** This callback lets us know more data has arrived via notification on the characteristic</span><br><span class="line"> *&#x2F;</span><br><span class="line">func peripheral(_ peripheral: CBPeripheral, didUpdateValueFor characteristic: CBCharacteristic, error: Error?) &#123;</span><br><span class="line">  if let e &#x3D; error &#123;</span><br><span class="line">    print(&quot;Error discovering characteristics \(e)&quot;, e.localizedDescription)</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  guard let value &#x3D; characteristic.value else &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  let stringFromData &#x3D; String(data: value, encoding: String.Encoding.utf8)</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; If we need to stop subscription after receive all data</span><br><span class="line">  if (stringFromData &#x3D;&#x3D; &quot;EOM&quot;) &#123;</span><br><span class="line">    &#x2F;&#x2F; data all sent</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; cancel our subscription to the characteristic</span><br><span class="line">    peripheral.setNotifyValue(false, for: characteristic)</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; and disconnect from the peripheral</span><br><span class="line">    centralManager.cancelPeripheralConnection(peripheral)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Otherwise, just add the data on to what we already have</span><br><span class="line">  dataReceived?.append(value)</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Log it</span><br><span class="line">  print(&quot;Received: \(String(describing: stringFromData))&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Handle-Connection-Loss"><a href="#Handle-Connection-Loss" class="headerlink" title="Handle Connection Loss"></a>Handle Connection Loss</h2><p>We need to implement <code>didUpdateNotificationStateFor</code> as well to handle when we lost connection with the central. If we are no longer notify the central, call <code>cancelPeripheralConnection</code> to disconnect.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;** The peripheral letting us know whether our subscribe&#x2F;unsubscribe happened or not</span><br><span class="line"> *&#x2F;</span><br><span class="line">func peripheral(_ peripheral: CBPeripheral, didUpdateNotificationStateFor characteristic: CBCharacteristic, error: Error?) &#123;</span><br><span class="line">  if let e &#x3D; error &#123;print(&quot;Error changing notification state \(e.localizedDescription)&quot;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Exit if it&#39;s not the transfer characteristic</span><br><span class="line">  if (!characteristic.uuid.isEqual(CBUUID(string: characteristicUUIDString))) &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Notification has started</span><br><span class="line">  if (characteristic.isNotifying) &#123;</span><br><span class="line">    print(&quot;notification began on \(characteristic)&quot;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; Notification has stopped</span><br><span class="line">  else &#123;</span><br><span class="line">    &#x2F;&#x2F; so disconnect from the peripheral</span><br><span class="line">    print(&quot;Notification stopped on \(characteristic). Disconnecting&quot;)</span><br><span class="line">    centralManager.cancelPeripheralConnection(peripheral)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="After-Disconnect-Peripheral"><a href="#After-Disconnect-Peripheral" class="headerlink" title="After Disconnect Peripheral"></a>After Disconnect Peripheral</h2><p>When we successfully connects to peripheral, <code>didDisconnectPeripheral</code> will get called and you can handle anything there to clean things up. In the example below, it just clear out the peripheral it previously stored.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;** Once the disconnection happens, we need to clean up our local copy of the peripheral</span><br><span class="line"> *&#x2F;</span><br><span class="line">func centralManager(_ central: CBCentralManager, didDisconnectPeripheral peripheral: CBPeripheral, error: Error?) &#123;</span><br><span class="line">  print(&quot;Peripheral Disconnected&quot;)</span><br><span class="line">  discoveredPeripheral &#x3D; nil</span><br><span class="line">  scan()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Manually-Disconnect"><a href="#Manually-Disconnect" class="headerlink" title="Manually Disconnect"></a>Manually Disconnect</h2><p>This can happen on various case. For example, you just don&#39;t need to monitoring the device anymore. Or something went wrong and you want to clean everything up.</p>
<p>So the following code cancels any subscription if there are any, or straight disconnects if not.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;** Call this when things either go wrong, or you&#39;re done with the connection.</span><br><span class="line"> *  This cancels any subscriptions if there are any, or straight disconnects if not.</span><br><span class="line"> *  (didUpdateNotificationStateForCharacteristic will cancel the connection if a subscription is involved)</span><br><span class="line"> *&#x2F;</span><br><span class="line">func cleanup() &#123;</span><br><span class="line">  &#x2F;&#x2F; don&#39;t do anything if we&#39;re not connected</span><br><span class="line">  guard let peripheral &#x3D; discoveredPeripheral, peripheral.state &#x3D;&#x3D; .connected else &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; see if we are subscribed to a characteristic on the peripheral</span><br><span class="line">  if let services &#x3D; self.discoveredPeripheral?.services &#123;</span><br><span class="line">    for service in services &#123;</span><br><span class="line">      if let characteristics &#x3D; service.characteristics &#123;</span><br><span class="line">        for characteristic in characteristics &#123;</span><br><span class="line">          if characteristic.uuid &#x3D;&#x3D; CBUUID(string: characteristicUUIDString) &#123;</span><br><span class="line">            if characteristic.isNotifying &#123;</span><br><span class="line">              &#x2F;&#x2F; It is notifying, so unsubscribe</span><br><span class="line">              discoveredPeripheral?.setNotifyValue(false, for: characteristic)</span><br><span class="line"></span><br><span class="line">              &#x2F;&#x2F; And we&#39;re done</span><br><span class="line">              return</span><br><span class="line">            &#125;&#125;&#125;&#125;&#125;&#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; If we&#39;ve got this far, we&#39;re connected, but we&#39;re not subsctibed, so we just disconnect</span><br><span class="line">  centralManager.cancelPeripheralConnection(peripheral)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div></article></div></section><footer><div class="paginator"><a href="/2017/05/02/Android%20Bluetooth%20LE%20Peripheral/" class="prev">PREV</a><a href="/2017/04/21/Get%20Current%20Wifi%20Connection/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'nuynait';
var disqus_identifier = '2017/05/02/Apple Bluetooth LE Central/';
var disqus_title = 'Apple Bluetooth LE Central';
var disqus_url = 'http://blog.jerryshan.com/2017/05/02/Apple Bluetooth LE Central/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//nuynait.disqus.com/count.js" async></script><!-- block copyright--></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>