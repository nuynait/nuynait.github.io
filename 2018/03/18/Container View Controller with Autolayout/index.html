<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Container View Controller · Tianyun Shan</title><meta name="description" content="Container View Controller - Tianyun Shan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/img.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.jerryshan.com/atom.xml" title="Tianyun Shan"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/img.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Container View Controller</h1><div class="post-info">Mar 18, 2018</div><div class="post-content"><p>Introduce: Add / Remove Child View Controller</p>
<span id="more"></span>

<h1 id="Add-Child-View-Controllers"><a href="#Add-Child-View-Controllers" class="headerlink" title="Add Child View Controllers"></a>Add Child View Controllers</h1><p>Before adding the child view controller into the container’s hierarchy, we need to init the child view controller and save it as a property inside the container view controller.</p>
<p>Firstly, the container view controller call the <code>addChildViewController:</code> method. This method is basically saying now my container is managing the view of that child view controller.</p>
<p>Secondly, add child’s root view to subview of any of your container’s view. Remember to setup the constraints for your child’s root view to match its super view after its being added.</p>
<p>Last, call <code>didMoveToParentViewController</code> method on child view and pass in the container view controller.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ContainerViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> childViewController: <span class="type">ChildViewController</span> <span class="operator">=</span> <span class="type">ChildViewController</span>(nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// inside some function, we add it that child view controller</span></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">addChildViewController</span>()</span> &#123;</span><br><span class="line">    addChildViewController(childViewController)</span><br><span class="line">    view.addSubview(childViewController.view)</span><br><span class="line">    childViewController.addParentsConstraints() <span class="comment">// this is a method we implement later</span></span><br><span class="line">    childViewController.didMove(toParentViewController: <span class="keyword">self</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChildViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">addParentsConstraints</span>()</span> &#123;</span><br><span class="line">    <span class="comment">// now the constraints will be full screen</span></span><br><span class="line">    <span class="comment">// you should add constraints depending on what you needed</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> superview <span class="operator">=</span> view.superview <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;error, should call addParentsConstraints after adding this as subview to container&quot;</span>)</span><br><span class="line">      abort()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> viewDict <span class="operator">=</span> <span class="type">Dictionary</span>(dictionaryLiteral: (<span class="string">&quot;self&quot;</span>, <span class="keyword">self</span>.view))</span><br><span class="line">    <span class="keyword">let</span> horizontalLayout <span class="operator">=</span> <span class="type">NSLayoutConstraint</span>.constraints(</span><br><span class="line">      withVisualFormat: <span class="string">&quot;|[self]|&quot;</span>, options: <span class="type">NSLayoutFormatOptions</span>.directionLeadingToTrailing, metrics: <span class="literal">nil</span>, views: viewDict)</span><br><span class="line">    <span class="keyword">let</span> verticalLayout <span class="operator">=</span> <span class="type">NSLayoutConstraint</span>.constraints(</span><br><span class="line">      withVisualFormat: <span class="string">&quot;V:|[self]|&quot;</span>, options: <span class="type">NSLayoutFormatOptions</span>.directionLeadingToTrailing, metrics: <span class="literal">nil</span>, views: viewDict)</span><br><span class="line">    superview.addConstraints(horizontalLayout)</span><br><span class="line">    superview.addConstraints(verticalLayout)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Remove-Child-View-Controllers"><a href="#Remove-Child-View-Controllers" class="headerlink" title="Remove Child View Controllers"></a>Remove Child View Controllers</h1><p>Firstly, call the <code>willMoveToParentViewController</code> method on child view controller and pass in <code>nil</code>. Secondly, remove the child view controller’s root view from its superview. Lastly, call <code>removeFromParentViewController</code> on child view controller</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ContainerViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> childViewController: <span class="type">UIViewController</span> <span class="operator">=</span> <span class="type">UIViewController</span>(nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">removeChildViewController</span>()</span> &#123;</span><br><span class="line">    childViewController.willMove(toParentViewController: <span class="literal">nil</span>)</span><br><span class="line">    childViewController.view.removeFromSuperView()</span><br><span class="line">    childViewController.removeFromParentViewController()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Memory-Management"><a href="#Memory-Management" class="headerlink" title="Memory Management"></a>Memory Management</h1><p>You don’t need to remove child view controller to avoid retain cycles. Add as child will not create retain cycles at all. If you have a retain cycle, see if you have pass any parents function and stored as blocks in its child property.</p>
<p>If you are store parents function in child’s property as a closure, you might notice that it does not let you add weak or unowned keywords on non-class reference. If you still store it as is, then it will create a retain cycle if you are reference to self in that function block. What you can do is instead store the function, pass the parent itself and give it an unowned property. When you want to call that function, just call from access parent.</p>
</div></article></div></section><footer><div class="paginator"><a href="/2018/03/19/Dynamic%20Height%20Table%20View/" class="prev">PREV</a><a href="/2018/03/18/Set%20Corner%20Radius%20For%20Different%20Corner/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'nuynait';
var disqus_identifier = '2018/03/18/Container View Controller with Autolayout/';
var disqus_title = 'Container View Controller';
var disqus_url = 'http://blog.jerryshan.com/2018/03/18/Container View Controller with Autolayout/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//nuynait.disqus.com/count.js" async></script><!-- block copyright--></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>